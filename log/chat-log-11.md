# 現在 CPU の石が置けるかの判定にリバーシの基本ルールである挟んだ場合の条件がありません

## ユーザーからの依頼内容

```
現在CPUの石が置けるかの判定にリバーシの基本ルールである挟んだ場合の条件がありません。
こちらを修正してほしいです。
まずは、テストを修正を修正して、npm run formatでフォーマット後に変更したファイルのコミットをお願いします。
その後、実装を修正してフォーマット後に再度コミットして欲しいです。
```

## AI の回答

CPU の石を置くロジックにリバーシの基本ルール（挟んだ場合の条件）が不足しているとのことですね。まずは現在の CPU プレイヤーのコードを確認し、テストを修正してから実装を修正していきます。

まず、関連するファイルを見てみましょう。

[ファイルの確認と分析]

確認したところ、予想通り CPU プレイヤーの実装では、石を置ける位置の判定が「空のマス」のみで行われており、リバーシのルールである「相手の石を挟む」という条件が考慮されていないことがわかりました。

まず弱い CPU プレイヤー（WeakCpuPlayer）のテストを修正し、その後実装を修正していきます。

### 1. テストの修正

WeakCpuPlayer と NormalCpuPlayer のテストを修正し、リバーシのルールに基づいた正しいテストケースに変更しました。

変更内容：

- 空のマスではなく、相手の石を挟める位置のみが有効な移動先となるようにテストケースを修正
- テストケースの説明をより明確に
- より実践的なボード状態でのテストを追加

### 2. 実装の修正

CPU プレイヤーの実装を修正し、リバーシのルールに基づいた石の配置判定を実装しました。

主な変更点：

1. `cpu-player-types.ts` にリバーシのルールに基づいた石の配置判定に必要な共通の関数を実装

   - 石を挟める位置の判定
   - 方向ごとの石の判定
   - 利用可能な位置の取得

2. `weak-cpu-player.ts` と `normal-cpu-player.ts` を修正
   - 共通の判定関数を使用するように変更
   - それぞれの CPU の特徴（ランダム選択や角・端の優先）は維持

これらの変更により、CPU プレイヤーはリバーシの基本ルールに従って、相手の石を挟める位置にのみ石を置くようになりました。

### コミット履歴

1. テストの修正:

```
🚨 [Tests]: リバーシの基本ルール（石を挟む条件）をCPUプレイヤーのテストに反映
```

2. 実装の修正:

```
✨ [New Feature]: CPUプレイヤーにリバーシの基本ルール（石を挟む条件）を実装
```
